2023-12-16 17:16:42,053 - INFO - 
Config:
'add_train': False
'batch_size': 64
'continue_flag': ''
'cur_time': '2023_12_16_17_12_28'
'debug_mode': False
'debug_num': 500
'do_continue_train': False
'do_figure_save': False
'do_log_print_to_screen': True
'do_log_save_to_file': True
'do_predict': True
'do_train': True
'do_train_visualized': False
'dropout_rate': 0.2
'epoch': 20
'feature_columns': [2, 3, 4, 5, 6, 7, 8]
'figure_save_path': './figure/'
'hidden_size': 128
'input_size': 7
'label_columns': [4, 5]
'label_in_feature_index': [2, 3]
'learning_rate': 0.001
'log_save_path': './log/2023_12_16_17_12_28_pytorch/'
'lstm_layers': 2
'model_postfix': {'pytorch': '.pth'
'keras': '.h5'
'tensorflow': '.ckpt'}
'model_save_path': 'D:\\zcj\\myweb\\teststock\\prediction\\LSTMPredictStock\\saved_models/'
'output_size': 2
'patience': 5
'predict_day': 1
'random_seed': 42
'shuffle_train_data': True
'time_step': 20
'train_data_path': 'D:\\zcj\\myweb\\teststock\\prediction\\LSTMPredictStock\\data/py'
'train_data_rate': 0.95
'use_cuda': False
'used_frame': 'pytorch'
'valid_data_rate': 0.15
2023-12-16 17:16:44,194 - INFO - Epoch 0/20
2023-12-16 17:16:47,929 - INFO - The train loss is 0.285340. The valid loss is 0.063981.
2023-12-16 17:16:48,023 - INFO - Epoch 1/20
2023-12-16 17:16:49,476 - INFO - The train loss is 0.046137. The valid loss is 0.028191.
2023-12-16 17:16:49,482 - INFO - Epoch 2/20
2023-12-16 17:16:50,833 - INFO - The train loss is 0.025009. The valid loss is 0.015378.
2023-12-16 17:16:50,840 - INFO - Epoch 3/20
2023-12-16 17:16:52,108 - INFO - The train loss is 0.015801. The valid loss is 0.009300.
2023-12-16 17:16:52,112 - INFO - Epoch 4/20
2023-12-16 17:16:53,397 - INFO - The train loss is 0.011997. The valid loss is 0.006942.
2023-12-16 17:16:53,402 - INFO - Epoch 5/20
2023-12-16 17:16:54,680 - INFO - The train loss is 0.010314. The valid loss is 0.005808.
2023-12-16 17:16:54,685 - INFO - Epoch 6/20
2023-12-16 17:16:56,063 - INFO - The train loss is 0.009479. The valid loss is 0.005327.
2023-12-16 17:16:56,069 - INFO - Epoch 7/20
2023-12-16 17:16:57,373 - INFO - The train loss is 0.008905. The valid loss is 0.005103.
2023-12-16 17:16:57,378 - INFO - Epoch 8/20
2023-12-16 17:16:58,631 - INFO - The train loss is 0.008604. The valid loss is 0.005018.
2023-12-16 17:16:58,636 - INFO - Epoch 9/20
2023-12-16 17:16:59,928 - INFO - The train loss is 0.008345. The valid loss is 0.004973.
2023-12-16 17:16:59,934 - INFO - Epoch 10/20
2023-12-16 17:17:01,223 - INFO - The train loss is 0.008123. The valid loss is 0.004834.
2023-12-16 17:17:01,229 - INFO - Epoch 11/20
2023-12-16 17:17:02,513 - INFO - The train loss is 0.007953. The valid loss is 0.004703.
2023-12-16 17:17:02,517 - INFO - Epoch 12/20
2023-12-16 17:17:03,822 - INFO - The train loss is 0.007840. The valid loss is 0.004720.
2023-12-16 17:17:03,824 - INFO - Epoch 13/20
2023-12-16 17:17:05,098 - INFO - The train loss is 0.007732. The valid loss is 0.004663.
2023-12-16 17:17:05,103 - INFO - Epoch 14/20
2023-12-16 17:17:06,361 - INFO - The train loss is 0.007861. The valid loss is 0.004900.
2023-12-16 17:17:06,363 - INFO - Epoch 15/20
2023-12-16 17:17:07,643 - INFO - The train loss is 0.007667. The valid loss is 0.004851.
2023-12-16 17:17:07,645 - INFO - Epoch 16/20
2023-12-16 17:17:08,931 - INFO - The train loss is 0.007714. The valid loss is 0.004860.
2023-12-16 17:17:08,932 - INFO - Epoch 17/20
2023-12-16 17:17:10,238 - INFO - The train loss is 0.007585. The valid loss is 0.004847.
2023-12-16 17:17:10,239 - INFO - Epoch 18/20
2023-12-16 17:17:11,612 - INFO - The train loss is 0.007613. The valid loss is 0.004806.
2023-12-16 17:17:11,613 - INFO -  The training stops early in epoch 18
2023-12-16 17:17:12,288 - INFO - The mean squared error of stock ['low', 'high'] is [0.00072267 0.00195825]
2023-12-16 17:17:58,699 - ERROR - Internal Server Error: /prediction/pred
Traceback (most recent call last):
  File "D:\zcj\myweb\venv\lib\site-packages\django\core\handlers\exception.py", line 55, in inner
    response = get_response(request)
  File "D:\zcj\myweb\venv\lib\site-packages\django\core\handlers\base.py", line 197, in _get_response
    response = wrapped_callback(request, *callback_args, **callback_kwargs)
  File "D:\zcj\myweb\teststock\prediction\views.py", line 35, in pred
    predic.train_model(stock_code)
  File "D:\zcj\myweb\teststock\prediction\LSTMPredictStock\predic.py", line 101, in train_model
    model.train_generator(
  File "D:\zcj\myweb\teststock\prediction\LSTMPredictStock\core\model.py", line 92, in train_generator
    self.model.fit_generator(
  File "D:\zcj\myweb\venv\lib\site-packages\keras\engine\training.py", line 2209, in fit_generator
    return self.fit(
  File "D:\zcj\myweb\venv\lib\site-packages\keras\utils\traceback_utils.py", line 67, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "D:\zcj\myweb\venv\lib\site-packages\tensorflow\python\eager\execute.py", line 54, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.UnknownError: Graph execution error:

ZeroDivisionError: float division by zero
Traceback (most recent call last):

  File "D:\zcj\myweb\venv\lib\site-packages\tensorflow\python\ops\script_ops.py", line 271, in __call__
    ret = func(*args)

  File "D:\zcj\myweb\venv\lib\site-packages\tensorflow\python\autograph\impl\api.py", line 642, in wrapper
    return func(*args, **kwargs)

  File "D:\zcj\myweb\venv\lib\site-packages\tensorflow\python\data\ops\dataset_ops.py", line 1004, in generator_py_func
    values = next(generator_state.get_iterator(iterator_id))

  File "D:\zcj\myweb\venv\lib\site-packages\keras\engine\data_adapter.py", line 830, in wrapped_generator
    for data in generator_fn():

  File "D:\zcj\myweb\teststock\prediction\LSTMPredictStock\core\data_processor.py", line 70, in generate_train_batch
    x, y = self._next_window(i, seq_len, normalise)

  File "D:\zcj\myweb\teststock\prediction\LSTMPredictStock\core\data_processor.py", line 79, in _next_window
    window = self.normalise_windows(window, single_window=True)[0] if normalise else window

  File "D:\zcj\myweb\teststock\prediction\LSTMPredictStock\core\data_processor.py", line 93, in normalise_windows
    normalised_col = [

  File "D:\zcj\myweb\teststock\prediction\LSTMPredictStock\core\data_processor.py", line 94, in <listcomp>
    ((float(p) / float(window[0, col_i])) - 1) for p in window[:, col_i]

ZeroDivisionError: float division by zero


	 [[{{node PyFunc}}]]
	 [[IteratorGetNext]] [Op:__inference_train_function_7925]
